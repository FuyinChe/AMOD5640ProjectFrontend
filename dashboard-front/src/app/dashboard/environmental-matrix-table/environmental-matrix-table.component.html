<div class="dashboard__matrix-table__actions download-buttons" style="justify-content: flex-end; gap: 1.2rem;">
  <button class="chart__download-btn chart__download-btn--csv" (click)="downloadCSV()">
    <i class="fas fa-file-csv"></i>
    CSV
  </button>
  <button class="chart__download-btn chart__download-btn--png" (click)="downloadPNG()">
    <i class="fas fa-file-image"></i>
    PNG
  </button>
</div>
<table #matrixTable class="dashboard__matrix-table__table">
  <thead>
    <tr class="dashboard__matrix-table__header">
      <th class="dashboard__matrix-table__header-cell">Metric</th>
      <th *ngFor="let month of months" class="dashboard__matrix-table__header-cell">{{ month }}</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let metric of metrics" class="dashboard__matrix-table__row">
      <td class="dashboard__matrix-table__cell">
        {{ metric.name }} <span *ngIf="metric.unit">({{ metric.unit }})</span>
      </td>
      <td *ngFor="let value of metric.values; let i = index"
          class="dashboard__matrix-table__cell"
          [ngStyle]="{'background-color': getCellColor(value, getMin(metric), getMax(metric))}"
          [ngClass]="{'dashboard__matrix-table__cell--null': value === null}">
        {{ value === null ? '-' : (value | number:'1.2-2') }}
      </td>
    </tr>
  </tbody>
</table> 